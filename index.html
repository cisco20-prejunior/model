<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <link
            href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
            rel="stylesheet"
            integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
            crossorigin="anonymous"
        />
        <script
            src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
            crossorigin="anonymous"
        ></script>
        <link
            rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css"
            integrity="sha512-NhSC1YmyruXifcj/KFRWoC561YpHpc5Jtzgvbuzx5VozKpWvQ+4nXhPdFgmx8xqexRcpAglTj9sIBWINXa8x5w=="
            crossorigin="anonymous"
            referrerpolicy="no-referrer"
        />
        <style>
            body {
                margin: 10px;
            }
            div {
                margin: 10px;
            }
        </style>
        <title>Predictor</title>
    </head>
    <body class="text-bg-dark p-3">
        <h1>Ingrese los datos</h1>
        <div class="container d-flex flex-row">
        <div class="card g-col-6" style="width: 18rem">
            <ul class="list-group list-group-flush">
                <li class="list-group-item">
                    <div class="input-group mb-3">
                        <input
                            type="number"
                            name="long"
                            id="long"
                            class="form-control"
                        />
                        <span class="input-group-text" id="basic-addon2"
                            >Latitud</span
                        >
                    </div>
                </li>
                <li class="list-group-item">
                    <div class="input-group mb-3">
                        <input
                            type="number"
                            name="lat"
                            id="lat"
                            class="form-control"
                            aria-describedby="basic-addon2"
                        />
                        <span class="input-group-text" id="basic-addon2"
                            >Longitud</span
                        >
                    </div>
                </li>
                <li class="list-group-item">
                    <div class="input-group mb-3">
                        <input
                            type="number"
                            name="prof"
                            id="prof"
                            class="form-control"
                            aria-describedby="basic-addon2"
                        />
                        <span class="input-group-text" id="basic-addon2"
                            >Profundidad</span
                        >
                    </div>
                </li>
                <li class="list-group-item">
                    <div class="input-group mb-3">
                        <input
                            type="number"
                            name="mag"
                            id="mag"
                            class="form-control"
                            aria-describedby="basic-addon2"
                        />
                        <span class="input-group-text" id="basic-addon2"
                            >Magnitud</span
                        >
                    </div>
                </li>
            </ul>
            <button
                type="button"
                class="btn btn-primary margin:10px"
                id="send"
                onclick="predecir()"
            >
                Predecir
            </button>
        </div>
        <iframe
        width="400"
        height="400"
        style="border:0"
        loading="lazy"
        allowfullscreen
        id = "map1"
        referrerpolicy="no-referrer-when-downgrade"
        src="https://www.google.com/maps/embed/v1/place?key=AIzaSyDGb0XAAOAgvEk_qtU5IR2AdQSGdlXCMoM
        &q= -16.405682659902258, -71.52059243404484
        &center= -16.405682659902258, -71.52059243404484">
      </iframe>
      <iframe
        width="400"
        height="400"
        style="border:0"
        loading="lazy"
        allowfullscreen
        referrerpolicy="no-referrer-when-downgrade"
        src="https://www.google.com/maps/embed/v1/place?key=AIzaSyDGb0XAAOAgvEk_qtU5IR2AdQSGdlXCMoM
        &q= -16.405682659902258, -71.52059243404484
        &center= -16.405682659902258, -71.52059243404484"
        id="map2"
        >
      </iframe>
    </div>
        <div class="card container g-col-6" id="cambio">
            <div class="card-body">
                <div class="">
                    <p id="resultado">Aquí se mostrará el resultado</p>
                </div>
            </div>
        </div>

        <script
            src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
            crossorigin="anonymous"
        ></script>
        <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@2.0.0/dist/tf.min.js"></script>
        </script>
        <script type="text/javascript">
            var modelo = null;
            //Cargar modelo
            (async () => {
                console.log("Cargando modelo...");
                modelo = await tf.loadLayersModel("model.json");
                console.log("Modelo cargado...");
            })();
            async function predecir() {
                let long = parseFloat(document.getElementById("long").value);
                let lat = parseFloat(document.getElementById("lat").value);
                let prof = parseFloat(document.getElementById("prof").value);
                let mag = parseFloat(document.getElementById("mag").value);
                document.getElementById("resultado").innerHTML;
                if (modelo != null) {
                    let tensor = tf.tensor2d([[long, lat, prof, mag]]);
                    console.log(tensor);
                    console.log(tensor.data());
                    let prediccion = modelo.predict(tensor);
                    let prediccionArray = await prediccion.array();
                    const [value1, value2, value3, value4] = prediccionArray[0];
                    document.getElementById("resultado").innerHTML =
                        "La longitud estimada es:  " +
                        value1.toFixed(4) +
                        ", la latitud es estimada es: " +
                        value2.toFixed(4) +
                        ", la profundidad es estimada es: " +
                        value3.toFixed(0) +
                        ", la magnitud esrtimada es: " +
                        value4.toFixed(1);
                    document.getElementById("cambio").classList =
                        "card text-bg-success p-3";
                    mapa1 = document.getElementById("map1")
                    mapa2 = document.getElementById("map2")
                    mapa1.src ="https://www.google.com/maps/embed/v1/place?key=AIzaSyDGb0XAAOAgvEk_qtU5IR2AdQSGdlXCMoM&q=" + long +","+ lat + "&center=" + long+","+ lat
                    mapa2.src="https://www.google.com/maps/embed/v1/place?key=AIzaSyDGb0XAAOAgvEk_qtU5IR2AdQSGdlXCMoM&q=" + value1 +","+ value2 + "&center=" + value1+","+ value2
                }
            }
        </script>
        <script async src="https://maps.googleapis.com/maps/api/js?key=<AIzaSyAjTsVhevKBrEiLHBekA2GLlH4nkht-xrg>&v=alpha&libraries=maps3d"></script>
    </body>
</html>
